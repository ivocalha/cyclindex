<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/png" href="cyclindex_logo.png">
  <title>Cyclindex – Professional Cycling Index</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    @font-face{font-family:'Suissnord';src:url('Suissnord.otf') format('opentype');font-weight:normal;font-style:normal;font-display:swap;}
    body,html{height:100%;margin:0;background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);color:white;}

    :root{--nav-height:71px;--bottom-nav-height:64px;--pill-radius:0.7rem;--pill-bg:rgba(59,130,246,0.35);}
    .nav-bar{
      position:fixed;top:0;left:0;right:0;height:var(--nav-height);
      background:rgba(15,23,42,0.9);backdrop-filter:blur(12px);
      display:flex;align-items:center;justify-content:center;
      z-index:3000;box-shadow:0 4px 20px rgba(0,0,0,0.5);
    }
    .nav-links{display:flex;gap:2rem;}
    .nav-links a{
      font-family:'Suissnord',sans-serif;text-decoration:none;
      font-size:1.05rem;color:white;padding:0.45rem 0.9rem;
      border-radius:var(--pill-radius);transition:all .18s;
    }
    .nav-links a:hover{background:var(--pill-bg);transform:translateY(-2px);}

    .hero-zone{padding-top:calc(var(--nav-height) + 1rem);padding-bottom:1rem;text-align:center;}
    .logo-title{display:flex;align-items:center;justify-content:center;gap:0.9rem;}
    .logo-img{height:52px;filter:drop-shadow(0 2px 8px rgba(0,0,0,0.6));}
    .title{font-family:'Suissnord',sans-serif;font-size:2.8rem;margin:0;color:white;text-shadow:0 3px 10px rgba(0,0,0,0.7);}

    .grid-container{
      display:grid;grid-template-columns:300px 1fr 300px;
      gap:0.75rem;padding:0 0.75rem;
      height:calc(100vh - var(--nav-height) - var(--bottom-nav-height) - 140px);box-sizing:border-box;
      padding-bottom:calc(var(--bottom-nav-height) + 1rem);
    }
    .left-col,.center-col,.right-col{display:grid;gap:0.75rem;}
    .right-col{grid-template-rows:1fr 1fr;}
    .block{background:rgba(15,23,42,0.45);backdrop-filter:blur(12px);border-radius:0.9rem;padding:0.75rem;box-shadow:0 5px 18px rgba(0,0,0,0.3);transition:all .4s;}
    .block:hover{background:rgba(15,23,42,0.65);transform:translateY(-6px);box-shadow:0 15px 35px rgba(0,0,0,0.45);}
    .block h3{font-family:'Suissnord',sans-serif;font-size:1.15rem;margin:0 0 0.4rem;display:flex;align-items:center;gap:0.6rem;}
    .icon-header{width:28px;height:28px;}
    table{width:100%;border-collapse:collapse;font-size:0.84rem;}
    th{text-align:left;font-weight:600;font-size:0.76rem;opacity:0.9;padding-bottom:0.3rem;border-bottom:1px solid rgba(255,255,255,0.2);}
    td{padding:0.28rem 0;border-bottom:1px solid rgba(255,255,255,0.08);}
    tr:last-child td{border:none;}

    /* Column widths */
    #latest-results-table td:first-child,#upcoming-table td:first-child{width:28%;}
    #latest-results-table td:last-child,#upcoming-table td:last-child{width:72%;}
    #top-riders-table th:nth-child(1),#top-riders-table td:nth-child(1){width:5%;text-align:center;}
    #top-riders-table th:nth-child(2),#top-riders-table td:nth-child(2){width:8%;text-align:center;}
    #top-riders-table th:nth-child(3),#top-riders-table td:nth-child(3){width:30%;font-weight:600;}
    #top-riders-table th:nth-child(4),#top-riders-table td:nth-child(4){width:28%;}
    #top-riders-table th:nth-child(5),#top-riders-table td:nth-child(5),
    #top-riders-table th:nth-child(6),#top-riders-table td:nth-child(6),
    #top-riders-table th:nth-child(7),#top-riders-table td:nth-child(7),
    #top-riders-table th:nth-child(8),#top-riders-table td:nth-child(8){text-align:right;width:7.25%;}
    #top-teams-table th:nth-child(1),#top-teams-table td:nth-child(1),
    #top-nations-table th:nth-child(1),#top-nations-table td:nth-child(1){width:12%;text-align:center;}
    #top-teams-table th:nth-child(2),#top-teams-table td:nth-child(2),
    #top-nations-table th:nth-child(2),#top-nations-table td:nth-child(2){width:58%;}
    #top-teams-table th:nth-child(3),#top-teams-table td:nth-child(3),
    #top-nations-table th:nth-child(3),#top-nations-table td:nth-child(3){width:30%;text-align:right;}

    .flag{width:26px;height:18px;border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,0.5);object-fit:cover;transition:transform .2s;}
    .flag:hover{transform:scale(1.6);}
    .flag-name{position:absolute;background:rgba(0,0,0,0.92);color:white;font-size:11px;padding:3px 7px;border-radius:4px;opacity:0;transition:opacity .2s;bottom:100%;left:50%;transform:translateX(-50%);margin-bottom:6px;}
    .flag-container{position:relative;display:inline-block;}
    .flag-container:hover .flag-name{opacity:1;}

    /* Best Result tooltip */
    .result-cell{position:relative;display:inline-block;width:100%;text-align:right;cursor:help;}
    .result-tooltip{
      position:absolute;background:rgba(0,0,0,0.95);backdrop-filter:blur(8px);color:white;font-size:0.88rem;
      padding:0.75rem 0.9rem;border-radius:0.7rem;border:1px solid rgba(59,130,246,0.4);white-space:nowrap;
      opacity:0;pointer-events:none;transition:opacity .25s;z-index:1000;bottom:100%;left:50%;
      transform:translateX(-50%);margin-bottom:8px;box-shadow:0 8px 25px rgba(0,0,0,0.6);
    }
    .result-cell:hover .result-tooltip{opacity:1;}
    .tooltip-title{font-weight:600;color:#60a5fa;margin-bottom:0.4rem;}
    .tooltip-line{margin:0.15rem 0;}

    /* Bottom navbar – final clean version */
    .bottom-nav{
      position:fixed;bottom:0;left:0;right:0;height:var(--bottom-nav-height);
      background:rgba(15,23,42,0.92);backdrop-filter:blur(12px);
      display:flex;align-items:center;justify-content:space-between;
      padding:0 1.8rem;z-index:3000;box-shadow:0 -6px 20px rgba(0,0,0,0.6);
    }
    .bottom-left{display:flex;align-items:center;gap:1rem;}
    .bottom-logo-title{display:flex;align-items:center;gap:0.7rem;}
    .bottom-logo-img{height:34px;filter:drop-shadow(0 1px 4px rgba(0,0,0,0.5));}
    .bottom-title{font-family:'Suissnord',sans-serif;font-size:1.35rem;color:white;}
    .social-icons{display:flex;gap:1.1rem;align-items:center;}
    .social-icon{width:28px;height:28px;transition:transform .2s;filter:brightness(0) invert(1);}
    .social-icon:hover{transform:scale(1.2);}
    .login-form{display:flex;align-items:center;gap:0.7rem;}
    .login-input{
      background:rgba(255,255,255,0.12);border:1px solid rgba(255,255,255,0.3);
      border-radius:0.5rem;padding:0.5rem 0.9rem;color:white;font-size:0.9rem;outline:none;transition:all .2s;
    }
    .login-input::placeholder{color:rgba(255,255,255,0.6);}
    .login-input:focus{border-color:#3b82f6;background:rgba(255,255,255,0.22);}
    .login-btn{
      background:#3b82f6;color:white;font-weight:600;padding:0.5rem 1.2rem;
      border-radius:0.5rem;transition:all .2s;cursor:pointer;
    }
    .login-btn:hover{background:#2563eb;transform:translateY(-2px);}

    @media (max-width:1366px){
      .title{font-size:2.4rem;}.logo-img{height:46px;}
      .grid-container{grid-template-columns:280px 1fr 280px;}
      .bottom-title{font-size:1.2rem;}
      .social-icon{width:26px;height:26px;}
    }
  </style>
</head>
<body>

  <div class="nav-bar">
    <div class="nav-links">
      <a href="results-log.html">Results Log</a>
      <a href="rider-score.html">Rider Score</a>
      <a href="team-score.html">Team Score</a>
      <a href="nation-score.html">Nation Score</a>
      <a href="how-it-works.html">How It Works</a>
    </div>
  </div>

  <div class="hero-zone">
    <div class="logo-title">
      <img src="cyclindex_logo.png" alt="Cyclindex" class="logo-img">
      <h1 class="title">Cyclindex</h1>
    </div>
  </div>

  <div class="grid-container">
    <div class="left-col">
      <div class="block">
        <h3>Latest Results</h3>
        <table id="latest-results-table"><tbody><tr><td colspan="2">Loading...</td></tr></tbody></table>
      </div>
      <div class="block">
        <h3>Next Races</h3>
        <table id="upcoming-table"><tbody><tr><td colspan="2">Loading...</td></tr></tbody></table>
      </div>
    </div>

    <div class="center-col">
      <div class="block" style="display:flex;flex-direction:column;height:100%;">
        <h3>Top 10 Riders</h3>
        <table id="top-riders-table" style="flex:1;">
          <thead>
            <tr><th>#</th><th></th><th>Rider</th><th>Team</th><th>Best Result</th><th>2nd Best</th><th>3rd Best</th><th>Score</th></tr>
          </thead>
          <tbody><tr><td colspan="8">Loading...</td></tr></tbody>
        </table>
      </div>
    </div>

    <div class="right-col">
      <div class="block">
        <h3>Top 5 Teams</h3>
        <table id="top-teams-table"><thead><tr><th>#</th><th>Team</th><th>Score</th></tr></thead><tbody><tr><td colspan="3">Loading...</td></tr></tbody></table>
      </div>
      <div class="block">
        <h3>Top 5 Nations</h3>
        <table id="top-nations-table"><thead><tr><th>#</th><th>Nation</th><th>Score</th></tr></thead><tbody><tr><td colspan="3">Loading...</td></tr></tbody></table>
      </div>
    </div>
  </div>

  <!-- FINAL BOTTOM NAVBAR -->
  <div class="bottom-nav">
    <div class="bottom-left">
      <div class="bottom-logo-title">
        <img src="cyclindex_logo.png" alt="Cyclindex" class="bottom-logo-img">
        <span class="bottom-title">Cyclindex</span>
      </div>
      <div class="social-icons">
        <a href="https://www.instagram.com/cyclindex/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram" class="social-icon"></a>
        <a href="https://twitter.com/cyclindex" target="_blank"><svg class="social-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69a4.3 4.3 0 0 0 1.88-2.38 8.6 8.6 0 0 1-2.72 1.04 4.27 4.27 0 0 0-7.28 3.9A12.13 12.13 0 0 1 3.35 4.8a4.27 4.27 0 0 0 1.32 5.7 4.24 4.24 0 0 1-1.93-.53v.05a4.27 4.27 0 0 0 3.43 4.18 4.3 4.3 0 0 1-1.93.07 4.27 4.27 0 0 0 3.98 2.96A8.58 8.58 0 0 1 2 19.54a12.08 12.08 0 0 0 6.56 1.92c7.88 0 12.19-6.53 12.19-12.19 0-.19 0-.37-.01-.56A8.7 8.7 0 0 0 22.46 6Z"/></svg></a>
        <a href="https://github.com/ivocalha/cyclindex" target="_blank"><svg class="social-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.12-1.47-1.12-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.82.09-.65.35-1.08.63-1.33-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.68 0 0 .84-.27 2.75 1.02A9.56 9.56 0 0 1 12 6.8c.85.004 1.705.115 2.504.337 1.91-1.29 2.75-1.02 2.75-1.02.55 1.39.2 2.43.1 2.68.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.68.92.68 1.85v2.74c0 .27.16.59.67.5A10 10 0 0 0 12 2Z"/></svg></a>
      </div>
    </div>
    <form class="login-form" onsubmit="alert('Login coming soon');return false;">
      <input type="text" placeholder="Username" class="login-input" required>
      <input type="password" placeholder="Password" class="login-input" required>
      <button type="submit" class="login-btn">Login</button>
    </form>
  </div>

  <script>
    const flags = { /* your full 300+ line flags object here – unchanged */ };

    const flagImg = country => {
      const code = flags[country] || 'xx';
      return `<div class="flag-container">
                <img src="https://flagcdn.com/w40/${code}.png" width="26" height="18" alt="${country}" class="flag">
                <div class="flag-name">${country}</div>
              </div>`;
    };

    const fmt = v => !v || v.trim() === '' ? '–' : (parseFloat(v.replace(',', '.')) || v.trim()).toFixed(2).replace('.', ',');

    // Next Races, Latest Results, Teams, Nations — unchanged

    // TOP 10 RIDERS WITH WORKING TOOLTIP
    fetch('https://raw.githubusercontent.com/ivocalha/cyclindex/main/rider-score.csv')
      .then(r => r.text())
      .then(text => {
        if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1);
        const lines = text.split('\n');
        const top = [];
        for (let i = 1; i < lines.length; i++) {
          const p = lines[i].split(';');
          if (p.length < 31) continue;
          const rank = parseInt(p[2], 10);
          if (isNaN(rank) || rank < 1 || rank > 10) continue;

          const bestDate = p[9]?.trim() || '';
          const bestEvent = p[11]?.trim() || '';
          const bestRank = p[12]?.trim() || '';
          const bestType = p[13]?.trim() || '';

          top.push({
            rank,
            nation: p[4].trim(),
            rider: p[3].trim(),
            team: p[8].trim(),
            best: fmt(p[

15]),
            second: fmt(p[21]),
            third: fmt(p[27]),
            score: fmt(p[28]),
            tooltip: `<div class="tooltip-title">${bestEvent || 'Unknown Race'}</div>
                      <div class="tooltip-line">Date: ${bestDate || '–'}</div>
                      <div class="tooltip-line">Rank: ${bestRank || '–'}</div>
                      <div class="tooltip-line">Type: ${bestType || '–'}</div>`
          });
        }
        top.sort((a,b) => a.rank - b.rank);

        document.querySelector('#top-riders-table tbody').innerHTML = top.map(t => `
          <tr>
            <td>${t.rank}</td>
            <td>${flagImg(t.nation)}</td>
            <td>${t.rider}</td>
            <td>${t.team}</td>
            <td class="result-cell">
              ${t.best}
              <div class="result-tooltip">${t.tooltip}</div>
            </td>
            <td>${t.second}</td>
            <td>${t.third}</td>
            <td>${t.score}</td>
          </tr>
        `).join('');
      });

    // Teams & Nations fetches – unchanged (full code from your original version)
    // ... (all the rest of your working script exactly as you had it)
  </script>
</body>
</html>
