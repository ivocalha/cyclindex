<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/png" href="cyclindex_logo.png">
  <title>Cyclindex – Professional Cycling Index</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    @font-face{font-family:'Suissnord';src:url('Suissnord.otf') format('opentype');font-weight:normal;font-style:normal;font-display:swap;}
    body,html{height:100%;margin:0;background:linear-gradient(135deg,#0f172a 0%,#1e40af 100%);color:white;font-family:system-ui,-apple-system,sans-serif;}
    .grid-container{display:grid;grid-template-columns:320px 1fr 320px;grid-template-rows:auto auto 1fr;height:100vh;gap:1rem;padding:1rem;max-width:1920px;margin:0 auto;}
    .hero-zone{grid-column:1/4;text-align:center;padding:0.5rem 0;}
    .logo-title{display:flex;align-items:center;justify-content:center;gap:1个百分点rem;}
    .logo-img{height:56px;filter:drop-shadow(0 3px 8px rgba(0,0,0,0.6));}
    .title{font-family:'Suissnord',sans-serif;font-size:3rem;margin:0;color:white;text-shadow:0 3px 10px rgba(0,0,0,0.7);}
    .left-col{grid-column:1;display:grid;grid-template-rows:auto auto 1fr;gap:0.75rem;}
    .center-col{grid-column:2;display:flex;flex-direction:column;gap:0.75rem;}
    .right-col{grid-column:3;display:grid;grid-template-rows:1fr 1fr;gap:0.75rem;}
    .block-compact{background:rgba(15,23,42,0.4);backdrop-filter:blur(12px);border-radius:1rem;padding:0.9rem;box-shadow:0 6px 20px rgba(0,0,0,0.25);transition:all .3s;}
    .block-compact:hover{transform:translateY(-4px);background:rgba(15,23,42,0.55);}
    .block-title{font-family:'Suissnord',sans-serif;font-size:1.25rem;margin:0 0 0.5rem;color:white;}
    .upcoming-table,.latest-table,.rank-table{width:100%;border-collapse:collapse;font-size:0.88rem;}
    .upcoming-table th,.latest-table th,.rank-table th{text-align:left;font-weight:600;font-size:0.8rem;opacity:0.85;padding-bottom:0.4rem;border-bottom:1px solid rgba(255,255,255,0.2);}
    .upcoming-table td,.latest-table td,.rank-table td{padding:0.35rem 0;border-bottom:1px solid rgba(255,255,255,0.08);}
    .upcoming-table tr:last-child td,.latest-table tr:last-child td,.rank-table tr:last-child td{border:none;}
    .icon-header{width:32px;height:32px;opacity:0.9;}
    .flex-header{display:flex;align-items:center;gap:0.75rem;margin-bottom:0.5rem;}
    .main-blocks{display:grid;grid-template-columns:repeat(5,1fr);gap:0.75rem;margin:0.75rem 0;}
    .main-block{background:rgba(255,255,255,0.25);backdrop-filter:blur(10px);border-radius:1rem;padding:0.75rem;text-align:center;transition:all .3s;font-size:0.9rem;}
    .main-block:hover{transform:translateY(-6px);background:rgba(255,255,255,0.38);}
    .main-icon{width:26px;height:26px;margin:0 auto 0.4rem;}
    @media (max-width:1400px){
      .grid-container{grid-template-columns:280px 1fr 280px;}
      .title{font-size:2.5rem;}
    }
    @media (max-width:1100px){
      .grid-container{grid-template-columns:1fr;grid-template-rows:auto auto auto auto auto auto;}
      .left-col,.center-col,.right-col{grid-column:1;}
      .hero-zone{grid-column:1;}
    }
  </style>
</head>
<body>
  <div class="grid-container">

    <!-- HERO -->
    <div class="hero-zone">
      <div class="logo-title">
        <img src="cyclindex_logo.png" alt="Cyclindex" class="logo-img">
        <h1 class="title">Cyclindex</h1>
      </div>
      <div class="main-blocks">
        <a href="results-log.html" class="main-block"><strong>Results<br>Log</strong><br><svg class="main-icon" viewBox="0 0 24 24"><path fill="white" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2Z"/></svg></a>
        <a href="rider-score.html" class="main-block"><strong>Rider<br>Score</strong><br><img src="rider_icon.png" class="main-icon"></a>
        <a href="team-score.html" class="main-block"><strong>Team<br>Score</strong><br><img src="team_icon.png" class="main-icon"></a>
        <a href="nation-score.html" class="main-block"><strong>Nation<br>Score</strong><br><img src="nation_icon.png" class="main-icon"></a>
        <a href="how-it-works.html" class="main-block"><strong>How It<br>Works</strong><br><svg class="main-icon" viewBox="0 0 24 24"><path fill="white" d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm1 17h-2v-2h2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg></a>
      </div>
    </div>

    <!-- LEFT COLUMN -->
    <div class="left-col">
      <div class="block-compact">
        <div class="flex-header"><svg class="icon-header" viewBox="0 0 24 24"><path fill="white" d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14z"/></svg><h3 class="block-title">Next 5 Races</h3></div>
        <table class="upcoming-table" id="upcoming-table"><tbody><tr><td colspan="4">Loading...</td></tr></tbody></table>
      </div>
      <div class="block-compact">
        <div class="flex-header"><svg class="icon-header" viewBox="0 0 24 24"><path fill="white" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2Z"/></svg><h3 class="block-title">Latest Results</h3></div>
        <table class="latest-table" id="latest-results-table"><tbody><tr><td colspan="2">Loading...</td></tr></tbody></table>
      </div>
    </div>

    <!-- CENTER COLUMN – TOP 10 RIDERS (KING) -->
    <div class="center-col">
      <div class="block-compact" style="flex:1;">
        <div class="flex-header"><img src="rider_icon.png" class="icon-header"><h3 class="block-title">Top 10 Riders</h3></div>
        <table class="rank-table" id="top-riders-table"><thead><tr><th>Rank</th><th>Rider</th><th>Score</th></tr></thead><tbody><tr><td colspan="3">Loading...</td></tr></tbody></table>
      </div>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="right-col">
      <div class="block-compact">
        <div class="flex-header"><img src="team_icon.png" class="icon-header"><h3 class="block-title">Top 5 Teams</h3></div>
        <table class="rank-table" id="top-teams-table"><thead><tr><th>Rank</th><th>Team</th><th>Score</th></tr></thead><tbody><tr><td colspan="3">Loading...</td></tr></tbody></table>
      </div>
      <div class="block-compact">
        <div class="flex-header"><img src="nation_icon.png" class="icon-header"><h3 class="block-title">Top 5 Nations</h3></div>
        <table class="rank-table" id="top-nations-table"><thead><tr><th>Rank</th><th>Nation</th><th>Score</th></tr></thead><tbody><tr><td colspan="3">Loading...</td></tr></tbody></table>
      </div>
    </div>
  </div>

  <!-- All scripts (unchanged, fully working) -->
  <script>
    const CALENDAR_URL = 'https://raw.githubusercontent.com/ivocalha/cyclindex/main/calendar.csv';
    fetch(CALENDAR_URL).then(r=>r.text()).then(csv=>{const lines=csv.trim().split('\n').slice(1);const today=new Date();today.setHours(0,0,0,0);const upcoming=[];for(const line of lines){const p=line.split(';');if(p.length<5)continue;const [d,m,y]=p[0].trim().split('/');const raceDate=new Date(`${y}-${m.padStart(2,'0')}-${d.padStart(2,'0')}`);if(isNaN(raceDate)||raceDate<today)continue;upcoming.push({date:p[0].trim(),country:p[1].trim(),race:p[2].trim(),cls:p[4].trim()});if(upcoming.length>=5)break;}document.querySelector('#upcoming-table tbody').innerHTML=upcoming.length?upcoming.map(r=>`<tr><td>${r.date}</td><td>${r.country}</td><td>${r.race}</td><td>${r.cls}</td></tr>`).join(''):'<tr><td colspan="4">No upcoming</td></tr>';});
  </script>

  <script>
    const RESULTS_LOG_URL = 'https://raw.githubusercontent.com/ivocalha/cyclindex/main/results-log.csv';
    fetch(RESULTS_LOG_URL).then(r=>r.text()).then(text=>{if(text.charCodeAt(0)===0xFEFF)text=text.slice(1);const lines=text.split('\n');const headers=lines[0].split(';');const dateIdx=headers.indexOf('Date'),compIdx=headers.indexOf('Competition');let maxDate=null,races=new Set();for(let i=1;i<lines.length;i++){const p=lines[i].split(';'),date=p[dateIdx]?.trim();if(!date)continue;const [d,m,y]=date.split('/'),cur=new Date(`${y}-${m.padStart(2,'0')}-${d.padStart(2,'0')}`);if(!maxDate||cur>maxDate){maxDate=cur;races=new Set([p[compIdx].trim()]);}else if(cur.getTime()===maxDate.getTime())races.add(p[compIdx].trim());}document.querySelector('#latest-results-table tbody').innerHTML=maxDate?Array.from(races).sort().map(r=>`<tr><td>${maxDate.toLocaleDateString('en-GB')}</td><td>${r}</td></tr>`).join(''):'<tr><td colspan="2">No results</td></tr>';});
  </script>

  <script>
    const RIDER_SCORE_URL = 'https://raw.githubusercontent.com/ivocalha/cyclindex/main/rider-score.csv';
    fetch(RIDER_SCORE_URL).then(r=>r.text()).then(text=>{if(text.charCodeAt(0)===0xFEFF)text=text.slice(1);const lines=text.split('\n');const headers=lines[0].split(';');const rankIdx=headers.indexOf('Rank'),riderIdx=headers.indexOf('Rider'),scoreIdx=headers.indexOf('Score');const top=[];for(let i=1;i<lines.length;i++){const p=lines[i].split(';');const rank=parseInt(p[rankIdx]||0);if(isNaN(rank)||rank<1||rank>10)continue;let score=p[scoreIdx]?.trim()||'';const num=parseFloat(score.replace(',','.'));if(!isNaN(num))score=num.toFixed(2).replace('.',',');top.push({rank,rider:p[riderIdx]?.trim()||'',score});}top.sort((a,b)=>a.rank-b.rank);document.querySelector('#top-riders-table tbody').innerHTML=top.map(t=>`<tr><td>${t.rank}</td><td>${t.rider}</td><td>${t.score}</td></tr>`).join('');});
  </script>

  <script>
    const TEAM_SCORE_URL = 'https://raw.githubusercontent.com/ivocalha/cyclindex/main/team-score.csv';
    fetch(TEAM_SCORE_URL).then(r=>r.text()).then(text=>{if(text.charCodeAt(0)===0xFEFF)text=text.slice(1);const lines=text.split('\n');const top=[];for(let i=1;i<lines.length;i++){const p=lines[i].split(';');if(p.length<17)continue;const rank=parseInt(p[2].trim()||0);if(isNaN(rank)||rank<1||rank>5)continue;const team=p[3].trim();let score=p[p.length-1].trim();const num=parseFloat(score.replace(',','.'));if(!isNaN(num))score=num.toFixed(2).replace('.',',');top.push({rank,team,score});}document.querySelector('#top-teams-table tbody').innerHTML=top.map(t=>`<tr><td>${t.rank}</td><td>${t.team}</td><td>${t.score}</td></tr>`).join('');});
  </script>

  <script>
    const NATION_SCORE_URL = 'https://raw.githubusercontent.com/ivocalha/cyclindex/main/nation-score.csv';
    fetch(NATION_SCORE_URL).then(r=>r.text()).then(text=>{if(text.charCodeAt(0)===0xFEFF)text=text.slice(1);const lines=text.split('\n');const top=[];for(let i=1;i<lines.length;i++){const p=lines[i].split(';');if(p.length<15)continue;const rank=parseInt(p[2].trim()||0);if(isNaN(rank)||rank<1||rank>5)continue;const nation=p[3].trim();let score=p[p.length-1].trim();const num=parseFloat(score.replace(',','.'));if(!isNaN(num))score=num.toFixed(2).replace('.',',');top.push({rank,nation,score});}document.querySelector('#top-nations-table tbody').innerHTML=top.map(t=>`<tr><td>${t.rank}</td><td>${t.nation}</td><td>${t.score}</td></tr>`).join('');});
  </script>
</body>
</html>
